{"version":3,"sources":["Homepage.js","InputComponent.js","App.js","index.js"],"names":["socket","io","Homepage","location","videoRef","useRef","peerVideoRef","useState","sessionActive","setSessionActive","name","setName","totalNames","setTotalNames","adminName","setAdminName","peerName","setPeerName","useEffect","queryString","parse","search","console","log","navigator","mediaDevices","getUserMedia","video","audio","then","stream","emit","current","srcObject","play","client","InitPeer","type","peer","Peer","initiator","trickle","on","remove","destroy","gotAnswer","data","offer","signal","answer","catch","err","map","index","className","ref","muted","withRouter","history","formData","setFormData","setErr","ListOfErrors","length","key","onSubmit","event","preventDefault","error","push","setTimeout","submitHandler","value","onChange","target","changeHandler","App","exact","path","component","InputComponent","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.2301502e.chunk.js","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\"\nimport Peer from \"simple-peer\"\nimport io from \"socket.io-client\"\nimport queryString from \"query-string\"\n\nconst hostname = \"localhost:4000\"\nconst socket = io(hostname)\n\nconst Homepage = ({ location }) => {\n  const videoRef = useRef(null)\n  const peerVideoRef = useRef(null)\n  const [sessionActive, setSessionActive] = useState(\"\")\n  //  const [adminStream, adminSetStream] = useState(\"\")\n  const [name, setName] = useState(\"\")\n  const [totalNames, setTotalNames] = useState([])\n  const [adminName, setAdminName] = useState(\"\")\n  const [peerName, setPeerName] = useState(\"\")\n\n  useEffect(() => {\n    const { name } = queryString.parse(location.search)\n    setName(name)\n    console.log(name)\n    navigator.mediaDevices\n      .getUserMedia({ video: true, audio: true })\n      .then((stream) => {\n        console.log(name)\n        socket.emit(\"NewClient\", name)\n        //  adminSetStream(stream)\n        videoRef.current.srcObject = stream\n        videoRef.current.play()\n        console.log(videoRef.current)\n\n        let client = {}\n\n        function InitPeer(type) {\n          console.log(\"peer received\")\n          let peer = new Peer({\n            initiator: type === \"init\" ? true : false,\n            stream: stream,\n            trickle: false,\n          })\n\n          console.log(\"peer\", peer)\n\n          peer.on(\"stream\", (stream) => {\n            console.log(\"stream\", stream)\n            if (peerVideoRef.current) {\n              peerVideoRef.current.srcObject = stream\n              peerVideoRef.current.play()\n            }\n          })\n\n          peer.on(\"close\", () => {\n            peerVideoRef.current.remove()\n            peer.destroy()\n            console.log(\"peer destroyed\")\n          })\n\n          return peer\n        }\n\n        socket.on(\"CreatePeer\", () => {\n          client.gotAnswer = false\n\n          let peer = InitPeer(\"init\")\n          peer.on(\"signal\", (data) => {\n            if (!client.gotAnswer) {\n              socket.emit(\"offer\", data)\n            }\n          })\n          client.peer = peer\n        })\n\n        socket.on(\"backOffer\", (offer) => {\n          let peer = InitPeer(\"notInit\")\n\n          peer.on(\"signal\", (data) => {\n            socket.emit(\"Answer\", data)\n          })\n          peer.signal(offer)\n          client.peer = peer\n        })\n\n        socket.on(\"backAnswer\", (answer) => {\n          client.gotAnswer = true\n          let peer = client.peer\n          peer.signal(answer)\n        })\n\n        socket.on(\"SessionActive\", () => {\n          setSessionActive(\"Session is active , Please comeback later\")\n          videoRef.current.remove()\n        })\n      })\n      .catch((err) => console.log(err))\n  }, [location.search])\n\n  // console.log(adminStream)\n  socket.on(\"sending names peer\", (data) => {\n    setTotalNames(data)\n  })\n\n  useEffect(() => {\n    totalNames &&\n      totalNames.map((data, index) => {\n        if (data === name) {\n          setAdminName(data)\n        } else {\n          setPeerName(data)\n        }\n      })\n  }, [totalNames, name])\n\n  return (\n    <div>\n      <h4 className='heading'> Welcome to video chat</h4>\n      <p className='heading'>{sessionActive}</p>\n\n      <div className='col-12 col-sm-6 d-flex justify-content-center '>\n        <h5 className='adminName'>{adminName}</h5>\n        <div className='embed-responsive embed-responsive-16by9 videoAdmin'>\n          <video ref={videoRef} className='embed-responsive-item' muted></video>\n        </div>\n      </div>\n\n      <div className='col-12 col-sm-6 d-flex justify-content-center '>\n        <h5 className='peerName'>{peerName}</h5>\n        <div className='embed-responsive embed-responsive-16by9 videoPeer'>\n          <video ref={peerVideoRef} className='\"embed-responsive-item\"'></video>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default Homepage\n","import React, { useState } from \"react\"\nimport { withRouter } from \"react-router-dom\"\n\nconst InputComponent = ({ history }) => {\n  const [formData, setFormData] = useState({\n    name: \"\",\n  })\n\n  const [err, setErr] = useState([])\n\n  const { name } = formData\n\n  const changeHandler = (event) => {\n    event.preventDefault()\n    setFormData({ ...formData, [event.target.name]: event.target.value })\n  }\n\n  const submitHandler = (event) => {\n    event.preventDefault()\n    //  console.log(name)\n\n    let error = []\n    if (!name) {\n      error.push(\"Name cannot be empty\")\n    }\n\n    if (error.length > 0) {\n      setErr(error)\n      setTimeout(() => {\n        setErr([])\n      }, 3000)\n    } else {\n      history.push(`/videochat?name=${name}`)\n    }\n  }\n\n  const ListOfErrors =\n    err.length > 0\n      ? err.map((data, index) => {\n          //    console.log(data)\n          return <div key={index}>{data}</div>\n        })\n      : \"\"\n  // console.log(name)\n\n  return (\n    <div className='container mt-4'>\n      <div className='col-md-6 m-auto'>\n        <div className='card  card-body card-color'>\n          <h4 className=' text-center  mt-2'> Video Chat </h4>\n          <h6 className='text-center mt-2 text-danger'> {ListOfErrors}</h6>\n          <form onSubmit={(event) => submitHandler(event)}>\n            <div className='form-group'>\n              <label className='text-dark'>Enter your Name: </label>\n              <input\n                className='form-control'\n                type='text'\n                name='name'\n                value={name}\n                onChange={(event) => changeHandler(event)}\n              />\n            </div>\n\n            <button className='btn btn-secondary form-control' type='submit'>\n              submit\n            </button>\n          </form>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default withRouter(InputComponent)\n","import React from \"react\"\nimport \"./App.css\"\nimport Homepage from \"./Homepage\"\nimport InputComponent from \"./InputComponent\"\nimport { Switch, BrowserRouter as Router, Route } from \"react-router-dom\"\nimport Rough from \"./Rough\"\n\nfunction App() {\n  return (\n    <Router>\n      <Switch>\n        <Route exact path='/' component={InputComponent}></Route>\n      </Switch>\n\n      <Switch>\n        <Route path='/videochat' component={Homepage}></Route>\n      </Switch>\n    </Router>\n  )\n}\n\nexport default App\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport App from \"./App\"\nimport \"./App.css\"\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n)\n"],"sourceRoot":""}